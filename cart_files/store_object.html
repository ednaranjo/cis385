
<!DOCTYPE html>
<html>
    <head>
        <title>CIS385 Store</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
        <script>
            window.onload = function () {

                var products = [
                    {
                        id: "p01", 
                        desc: "Men's Cleveland Cavaliers Fanatics Branded Heather Charcoal 2018 Eastern Conference Champions Locker Room T-Shirt", 
                        price: 34.99, 
                        image: "p01.jpg"
                    },
                    {
                        id: "p11", 
                        desc: "San Antonio Spurs Kawhi Leonard #2-Shirt", 
                        price: 34.99, 
                        image: "p11.jpg"
                    },
                    {
                        id: "p101", 
                        desc: "LeBron James Men's Navy Cleveland Cavaliers adidas Swingman Jersey", 
                        price: 36.99, 
                        image: "p101.jpg"
                    },
                    {
                        id: "p122", 
                        desc: "Kevin Love Cleveland Cavaliers #0 NBA Youth Road Jersey Wine", 
                        price: 35.99, 
                        image: "p122.jpg"
                    },
                    {
                        id: "p131", 
                        desc: "Tim Duncan San Antonio Spurs Jersey Name and Number T-Shirt", 
                        price: 35.99, 
                        image: "p131.jpg"
                    },
                    {
                        id: "p112", 
                        desc: "LeBron James Men's Navy Cleveland Cavaliers adidas Swingman Jersey", 
                        price: 35.99, 
                        image: "p112.jpg"
                    },
                    {
                        id: "p41", 
                        desc: "Women's Customized San Antonio Spurs Black Replica Basketball Jersey", 
                        price: 35.99, 
                        image: "p41.jpg"
                    },
                    {
                        id: "p81", 
                        desc: "Klay Thompson Golden State Warriors Charcoal Chinese New Year Name and Number T-shirt", 
                        price: 34.99, 
                        image: "p81.jpg"
                    },
                    {
                        id: "p113", 
                        desc: "NBA Cleveland Cavaliers Kyrie Irving #2 Men's Replica Jersey", 
                        price: 34.99, 
                        image: "p113.jpg"
                    },
                    {
                        id: "p52", 
                        desc: "Klay Thompson Golden State Warriors Jersey Name and Number T-Shirt", 
                        price: 38.00, 
                        image: "p52.jpg"
                    },
                    {
                        id: "p61", 
                        desc: "Stephen Curry Golden State Warriors #30 NBA Youth Climalite Player T-Shirt Blue", 
                        price: 34.99, 
                        image: "p61.jpg"
                    },
                    {
                        id: "p41", 
                        desc: "Women's Customized San Antonio Spurs Black Replica Basketball Jersey", 
                        price: 34.99, 
                        image: "p41.jpg"
                    },
                    {
                        id: "p02", 
                        desc: "Men's Cleveland Cavaliers Fanatics Branded Black 2018 Eastern Conference Champions Backcourt Roster T-Shirt", 
                        price: 34.99, 
                        image: "p02.jpg"
                    },
                    {
                        id: "p03", 
                        desc: "Women's Cleveland Cavaliers Fanatics Branded Heather Charcoal 2018 Eastern Conference Champions Locker Room V-Neck T-Shirt", 
                        price: 34.99, 
                        image: "p03.jpg"
                    },
                    {
                        id: "p04", 
                        desc: "Men's Cleveland Cavaliers LeBron James Fanatics Branded Burgundy 2018 NBA Finals Bound Player Name & Number T-Shirt", 
                        price: 34.99, 
                        image: "p04.jpg"},
                    {
                        id: "p05", 
                        desc: "Men's Cleveland Cavaliers Fanatics Branded Heather Charcoal 2018 Eastern Conference Champions Keyhole Slogan Long Sleeve T-Shirt", 
                        price: 34.99, 
                        image: "p05.jpg"
                    },
                    {
                        id: "p06", 
                        desc: "Women's Cleveland Cavaliers Fanatics Branded Heather Charcoal 2018 Eastern Conference Champions Keyhole Slogan Long Sleeve V-Neck T-Shirt", 
                        price: 35.99, 
                        image: "p06.jpg"
                    },
                    {
                        id: "p07", 
                        desc: "Men's Cleveland Cavaliers Fanatics Branded Gray 2018 NBA Finals Bound Catch and Shoot Tri-Blend T-Shirt", 
                        price: 36.99, 
                        image: "p07.jpg"
                    },
                    {
                        id: "p08", 
                        desc: "Women's Cleveland Cavaliers Fanatics Branded Heather Gray 2018 Eastern Conference Champions Catch and Shoot Tri-Blend Tank Top", 
                        price: 32.99, 
                        image: "p08.jpg"
                    },
                    {
                        id: "p09", 
                        desc: "Men's Cleveland Cavaliers Nike Red 2018 NBA Finals Bound City DNA Cotton Performance T-Shirt", 
                        price: 35.99, 
                        image: "p09.jpg"
                    },
                    {
                        id: "p10", 
                        desc: "Youth Golden State Warriors Stephen Curry Royal Backer T-Shirt", 
                        price: 24.99, 
                        image: "p10.jpg"
                    },
                    {
                        id: "p93", 
                        desc: "Men's Boston Celtics Jayson Tatum Fanatics Branded Kelly Green Backer Name & Number T-Shirt", 
                        price: 34.99, 
                        image: "p93.jpg"
                    },
                ];

                for (var i = 0; i < products.length; i++) {

                    var this_product = products[i];

                    document.getElementById("productsTbl").innerHTML +=
                            "<tr>" +
                            "<td valign='top'>" + this_product.id + "</td>" +
                            "<td valign='top'><img src='images/" + this_product.image + "' alt='Product'><br><h3>" + this_product.desc + "</h3></td>" +
                            "<td valign='top' align='right'>$" + this_product.price + "<br>\n\
        <button onclick='addToCart(\"" + this_product.id + "\",1)'>Add To Cart</button></td>" +
                            "</tr>";
                }

                details();

            };

            function addToCart(p, qty) {
                alert("Product " + getCookie(p) + " qty: " + qty);
                if (getCookie(p)) {
                    setCookie(p, (parseInt(getCookie(p)) + 1));
                } else {
                    setCookie(p, qty, 30);
                }


                details();
            }

            function details() {
                var cookievalue = "", str = document.cookie;
                var cookie_array = str.split(";");
                var x = "<table style='width:50%;' class='table'>";
                x += "<tr><th colspan='2'>Your Shopping Cart</th></tr>";
                x += "<tr><th>Product ID</th>";
                x += "<th>Product Description</th>";
                x += "<th>Unit Price</th>";
                x += "<th>Quantity</th>";
                x += "<th>Delete</th>";
                x += "</tr>";
                if (document.cookie.length != 0)
                    for (var i = 0; i < cookie_array.length; i++)
                    {
                        var B = cookie_array[i].split("=");
                        x += "<tr><td style='width:10;'>" + B[0] + "</td>";
                        x += "<td>" + filterIt(products,B[0]) + "</td>" +
                                "<td>0</td>" +
                                "<td style='width:10;'>" + B[1] + "</td>" +
                                "<td><input type='button' value='Delete' onclick='deleteProduct(\"" + B[0] + "\")'></td>" +
                                "</tr>";
                    }
                x += "</table>";
                document.getElementById("cart").innerHTML = x;
            }

            function setCookie(cname, cvalue, exdays) {
                var d = new Date();
                d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
                var expires = "expires=" + d.toUTCString();
                document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
            }

            function getCookie(cookie2find) {
                var cookievalue = "", str = document.cookie;
                var cookie_array = str.split(";");
                for (var i = 0; i < cookie_array.length; i++)
                {
                    var B = cookie_array[i].split("=");
                    var c2f = "";
                    if (i != 0)
                        c2f = " " + cookie2find;
                    else
                        c2f = cookie2find;
                    if (B[0] == c2f) {
                        cookievalue = B[1];
                        break;
                    }
                }
                return cookievalue;
            }

            function deleteProduct(p) {
                setCookie(p, "", -1);
                details();
            }

            function filterIt(arr, searchKey) {
                return arr.filter(function (obj) {
                    return Object.keys(obj).some(function (key) {
                        return obj[key].includes(searchKey);
                    })
                });
            }



        </script>
    </head>
    <body>
        <div id="cart"></div>
        <hr>
        <table style="width: 50%" class="table table-bordered">
            <thead>
                <tr>
                    <th>Product ID</th>
                    <th>Description</th>
                    <th>Price</th>
                </tr>
            </thead>
            <tbody id="productsTbl"></tbody>
        </table>
    </body>
</html>
